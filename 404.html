<!DOCTYPE html>
<!--W H A T   A R E   Y O U   D O I N G   I N   M Y   C O D E ? ! 
	
			⢀⡴⠑⡄⠀⠀⠀⠀⠀⠀⠀⣀⣀⣤⣤⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ 
			⠸⡇⠀⠿⡀⠀⠀⠀⣀⡴⢿⣿⣿⣿⣿⣿⣿⣿⣷⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⠑⢄⣠⠾⠁⣀⣄⡈⠙⣿⣿⣿⣿⣿⣿⣿⣿⣆⠀⠀⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⢀⡀⠁⠀⠀⠈⠙⠛⠂⠈⣿⣿⣿⣿⣿⠿⡿⢿⣆⠀⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⢀⡾⣁⣀⠀⠴⠂⠙⣗⡀⠀⢻⣿⣿⠭⢤⣴⣦⣤⣹⠀⠀⠀⢀⢴⣶⣆ 
			⠀⠀⢀⣾⣿⣿⣿⣷⣮⣽⣾⣿⣥⣴⣿⣿⡿⢂⠔⢚⡿⢿⣿⣦⣴⣾⠁⠸⣼⡿ 
			⠀⢀⡞⠁⠙⠻⠿⠟⠉⠀⠛⢹⣿⣿⣿⣿⣿⣌⢤⣼⣿⣾⣿⡟⠉⠀⠀⠀⠀⠀ 
			⠀⣾⣷⣶⠇⠀⠀⣤⣄⣀⡀⠈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀ 
			⠀⠉⠈⠉⠀⠀⢦⡈⢻⣿⣿⣿⣶⣶⣶⣶⣤⣽⡹⣿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⠀⠀⠀⠉⠲⣽⡻⢿⣿⣿⣿⣿⣿⣿⣷⣜⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣷⣶⣮⣭⣽⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⠀⠀⣀⣀⣈⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠇⠀⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⠀⠀⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⠀⠀⠀⠹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀ 
			⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⠻⠿⠿⠿⠿⠛⠉-->
<html lang="en">
	<head>
		<!-- PAGE TITLE -->
		<title> Page not found | Thronefall wiki</title>
		<!-- PAGE INFORMATION -->
		<meta name="description" content="Page not found">
		<meta name="keywords"    content="Thronefall, leaderBoard, grizzly games, speedrun, wiki, fandom">
		<meta name='author'      content="GhostMiner, ItsMeRaven"> 
		<meta name='robots'      content="index,follow">
		<meta name="language"    content="en">

		<!-- Tab icon-->
		<link rel="shortcut icon" type="image/png" href="/assets/images/crown.png">
		<!-- Responsive design-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Chatracter set-->
		<meta charset="utf-8">
		<!-- HTMX -->
		<script src="https://unpkg.com/htmx.org@1.9.4" integrity="sha384-zUfuhFKKZCbHTY6aRR46gxiqszMk5tcHjsVFxnUo8VMus4kHGVdIYVbOYYNlKmHV" crossorigin="anonymous"></script>
		<!-- jQuery  -->
		<script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>
		<!-- Various features -->
		<script src="/assets/scripts/pageOptions.js"></script>
		<!-- Article contents menu script -->
		<script src="/assets/scripts/contentsMenu.js"></script> 
		<!-- Dark mode -->
		<script src="/assets/scripts/darkmode.js"></script>
		<!-- Cookies -->
		<script src="/assets/scripts/cookies.js"></script>
	</head>
	<body>
        <style>
            /* body
            {
                background: url("https://ghost-miner.github.io/wp-content/uploads/2022/08/RICK-ASTLEY-ANIMATED.gif");
                background-size: contain;
                background-repeat: repeat;
            } */
            #lookingForSimPage
            {
                font-size: 1.25rem;
                font-weight: 500;
                display: none;
            }
            .codeBlock
            {
                font-size: 1rem;
            }
        </style>
		<!-- PAGE TITLE -->
		<h1 class="pageTitle"> Page not found </h1>
		<hr class="pageTitleUnderline">
		
		<!-- CONTENT GOES HERE -->
        <span id="lookingForSimPage">Redirecting from <var>*currUrl*</var> to <var>*newUrl*</var></span>
		
        <span class="pageSubtitle" id="possibleCauses">Possible causes:</span>
        <ul id="possibleCausesList">
            <li>You misspelt the address</li>
            <li>There is no page under this address</li>
            <li>A page with this address was deleted or moved elsewhere</li>
            <li>You forgot to include "about" or "game content" in the address. 
                <i>(e.g. <a href="https://throne-fall.github.io/about/overview.html">Throne-Fall.github.io<span style="text-decoration: underline; font-weight: 600;">/about</span>/overview.html)</a></i></li>
        </ul>    
	</body>
	
	<script src="/assets/scripts/pageBuilder.js"></script>
	<script>BuildPage(true);</script>
    <script>
        async function CheckForSimilarPages ()
        {
            // Hide default 404 page content
            $("#possibleCausesList")[0].style.display = "none"; 
            $("#possibleCauses")[0].style.display = "none";
            // Show reirect message
            $("#lookingForSimPage")[0].style.display = "block";

            // Add codeblock style to old and new url text
            $("var")[0].classList.add("codeBlock");
            $("var")[1].classList.add("codeBlock");

            const originalPath = location.pathname;
            let newPath = originalPath.toLowerCase();

            // Only spaces
            if (originalPath.includes("%20"))
            {
                newPath = originalPath.split("%20").join("-");
            } 
            // Only underscores
            if (originalPath.includes("_"))
            {
                newPath = originalPath.split("_").join("-");
            }
            // Both
            if (originalPath.includes("_") && originalPath.includes("%20"))
            {
                let tmpPath1 = originalPath.split("%20").join("-");
                let tmpPath2 = tmpPath1.split("_").join("-");
                newPath = tmpPath2;
            }
            // old name for Upgrades
            if (newPath.includes("upgrade-paths"))
            {
                const urlParts = newPath.split("/")
                for (let i = 0; i < urlParts.length; i++)
                {
                    if (urlParts[i].includes("upgrade"))
                    {
                        urlParts[i] = "upgrades";
                    }
                }
                console.log(urlParts.join("/"));
                newPath = urlParts.join("/");
            }

            // Set path to lowercase
            newPath = newPath.toLowerCase();
            // Remove .html from url text
            $("var")[0].textContent = originalPath.split(".")[0];
            $("var")[1].textContent = newPath.split(".")[0];

            // Data of page that were trying to access
            const data = await fetch(newPath);
            // The same page but in plain text
            const text = await data.text();

            // Proceeed to reidrect visitor to the address in new format
            if (!text.includes("<title> Page not found"))
            {
                $(".pageTitle")[0].textContent = "Old or incorrect name format.";
                document.title = "Old or incorrect name format.";

                const oldUrlParts = originalPath.split("/");
                const newUrlParts = newPath.split("/");

                milliseconds = 10; //1500; 
                setTimeout(() =>
                {
                    console.log('-----\nREDIRECTING TO ' + newPath + "\n-----");
                    // console.log("NEWPATH: " + newPath);
                    location.href = origin + newPath + "?redirfrom=" + originalPath.split(".")[0];
                }, milliseconds);
            }
            // Display default 404 page
            else
            {
                console.log('NOT FOUND');
                $("#possibleCausesList")[0].style.display = "block";
                $("#possibleCauses")[0].style.display = "block";
                $("#lookingForSimPage")[0].style.display = "none";
            }
        }
        CheckForSimilarPages();
    </script>
</html>
